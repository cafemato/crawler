<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ChartJS - BarGraph</title>
    <style type="text/css">
      #chart-container {
        width: 800px;
        height: auto;
      }
    </style>
  </head>
  <body>
    <div id="chart-container">
      <canvas id="mycanvas" width="400" height="400"></canvas>
    </div>

    <!-- javascript -->
    <!-- JQuery -->
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"></script>
    <!-- Chart JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <script>
      $(document).ready(function(){
      $.ajax({
        url: "http://localhost/data/data.php",
        method: "GET",
        success: function(data) {
          console.log(data[0]);
          var player = [];
          var score = [];
          var colorArr1 =[
                "rgba(255, 99, 132, 0.2)",
                "rgba(255, 159, 64, 0.2)",
                "rgba(255, 205, 86, 0.2)",
                "rgba(75, 192, 192, 0.2)",
                "rgba(54, 162, 235, 0.2)",
                "rgba(153, 102, 255, 0.2)",
                "rgba(201, 203, 207, 0.2)"
          ];
          var colorArr2 =[
                "rgb(255, 99, 132)",
                "rgb(255, 159, 64)",
                "rgb(255, 205, 86)",
                "rgb(75, 192, 192)",
                "rgb(54, 162, 235)",
                "rgb(153, 102, 255)",
                "rgb(201, 203, 207)"
          ];  

          for(var i in data[0].data1) {
            player.push(data[0].data1[i].industry);
            score.push(data[0].data1[i].counts);
          }
          

          var chartdata = {
            labels: player,
            datasets : [
              {
                label: '104',
                backgroundColor: colorArr1[0],
                borderColor: colorArr2[0],
                borderWidth: 1,
                hoverBackgroundColor: colorArr1[5],
                hoverBorderColor: colorArr2[5],
                data: score
              },
              {
                label: '1111',
                backgroundColor: colorArr1[1],
                borderColor: colorArr2[1],
                borderWidth: 1,
                hoverBackgroundColor: colorArr1[5],
                hoverBorderColor: colorArr2[5],
                data: score
              }
            ]
          };


          var ctx = $("#mycanvas");

          var barGraph = new Chart(ctx, {
            type: 'bar',
            data: chartdata,
            options: {
              title: {
                display: true,
                text: '[大數據]產業別之職缺數量',
                fontStyle: 'bold',
                fontColor: '#000',
                fontSize: 16
              },
              scales: {
                xAxes: [{
                  scaleLabel: {
                      display: true,
                      labelString: '產業名稱',
                      fontColor: '#333',
                      fontSize: 16
                  },
                  ticks: {
                    beginAtZero: true,
                    max: 70,
                    min: -10                   
                  }
                }],
                yAxes: [{
                  barPercentage: 0.9,
                  scaleLabel: {
                      display: true,
                      labelString: '職缺數目',
                      fontColor: '#333',
                      fontSize: 16
                  },
                }]
              },
              tooltips: {
                backgroundColor: 'rgba(0, 0, 0, 0.6)',
                borderWidth: 5,
                titleFontsize: 20
              },
              legend: {
                  display: true,
                  position: 'top'
                  
              }
            }  
          });
        },
        error: function(data) {
          console.log(data);
        }
      });
});

    </script>
  </body>
 </html>